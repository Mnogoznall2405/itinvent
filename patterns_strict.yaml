# Паттерны для поиска конфиденциальной информации (High Precision / Low Noise)
# Serch DSP - Document Scanner & Pattern Detector

patterns:
  # === УЧЕТНЫЕ ДАННЫЕ (CREDENTIALS) ===

  - id: password_strict
    name: Пароль
    type: regex
    pattern: '(?i)(?:пароль|password|pass|pwd)\s*[:=\-—]\s*["'']?([A-Za-z0-9!@#$%^&*]{6,64})["'']?(?!(?:\s*(?:запомнить|регистрация|вход)))'
    weight: 1.0
    flags:
      - ignorecase

  - id: login_strict
    name: Логин
    type: regex
    pattern: '(?i)(?:login|логин|user|username)\s*[:=\-—]\s*["'']?([a-zA-Z0-9._\-]{3,32})["'']?(?!(?:\s*[a-zA-Z0-9._\-]+@[a-zA-Z0-9._\-]+\.[a-zA-Z]{2,}))'
    weight: 0.7
    flags:
      - ignorecase

  # === ТОКЕНЫ И КЛЮЧИ ===

  - id: api_token
    name: API Key / Bearer Token
    type: regex
    pattern: '(?i)\b(api[_-]?key|auth(?:entication)?_token|access_token|bearer)\s*[:=]\s*["'']?([a-zA-Z0-9_\-]{16,})["'']?'
    weight: 1.0

  # === ГРИФЫ СЕКРЕТНОСТИ ===

  - id: dsp_official_use
    name: ДСП (Для служебного пользования)
    type: regex
    pattern: '(?i)Для\s+служебного\s+пользования'
    weight: 1.0
    flags:
      - ignorecase

  - id: dsp_with_exclusion
    name: ДСП с контекстом документа
    type: regex
    pattern: '(?i)Для\s+служебного\s+пользования(?:\s+(?:Экз\.|Экз\.?|№|N|#|экземпляр|с\s+контекстом))?(?!(?:\s+плита|\s+лист|\s*[:\-]\s*\d+мм|\s+\d+мм|.*?ДСП\s+22\s+мм|.*?столешница\s+ДСП|.*?стол\s+ДСП))'
    weight: 1.0
    flags:
      - ignorecase

  - id: secret_strict
    name: Секретно / Конфиденциально
    type: regex
    pattern: '(?i)(?:совершенно\s+секретно|top\s+secret|strictly\s+confidential|гриф\s*[:=]?\s*(?:секретно|secret))'
    weight: 1.0

  - id: trade_secret_strict
    name: Коммерческая тайна
    type: regex
    pattern: '(?i)(?:коммерческая\s+тайна|commercial\s+secret|trade\s+secret|режим\s+КТ)'
    weight: 1.0

  # === НОВЫЕ ТОЧНЫЕ ПАТТЕРНЫ ДЛЯ КОНФИДЕНЦИАЛЬНЫХ ДОКУМЕНТОВ ===

  - id: real_credentials_pair
    name: Учетные данные (логин/пароль пара)
    type: regex
    pattern: '(?i)(?:Логин|Login|User|Username)[:\s=]+([a-zA-Z0-9._\-]{3,32})[\s,;]+(?:Пароль|Password|Pass)[:\s=]+([A-Za-z0-9!@#$%^&*]{6,64})(?!\s*(?:запомнить|регистрация|вход))'
    weight: 1.0

  - id: admin_password
    name: Административный пароль
    type: regex
    pattern: '(?i)(?:admin|administrator|root)[\s:]+([a-zA-Z0-9]{3,32})[\s,;]+(?:password|пароль)[\s:]+([A-Za-z0-9!@#$%^&*]{6,64})'
    weight: 1.0

  - id: classified_document_header
    name: Заголовок секретного документа
    type: regex
    pattern: '(?i)(?:СОВЕРШЕННО\s+СЕКРЕТНО|СЕКРЕТНО|КОНФИДЕНЦИАЛЬНО|ДЛЯ\s+СЛУЖЕБНОГО\s+ПОЛЬЗОВАНИЯ)(?:.*?)(?:Экз\.|Экз\.?|№|N|#)[:\s]*\d+'
    weight: 1.0

  - id: internal_use_only
    name: Внутреннее использование
    type: regex
    pattern: '(?i)(?:Только\s+для\s+внутреннего\s+использования|Internal\s+Use\s+Only|Внутренний\s+документ|Не\s+для\s+распространения)'
    weight: 0.8

  - id: security_clearance
    name: Уровень допуска
    type: regex
    pattern: '(?i)(?:Допуск|Уровень\s+допуска)[:\s]*(?:особой\s+важности|совершенно\s+секретно|секретно|несекретно)'
    weight: 0.9

  - id: passport_rf_new
    name: Паспорт РФ (улучшенный)
    type: regex
    pattern: '(?i)(?:паспорт\s+РФ|российский\s+паспорт|удостоверение\s+личности)[:\s]*([А-Я]{2}\s*\d{6}|(\d{2}\s?\d{2})\s*№?\s*(\d{6}))'
    weight: 0.9

# Настройки оценки
scoring:
  combine: weighted_sum
  thresholds:
    dsp: 1.0      # Критическое совпадение
    review: 0.8   # Высокая вероятность (было 0.5, подняли для уменьшения шума)