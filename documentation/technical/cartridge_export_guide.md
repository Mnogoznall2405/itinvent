# –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–º–µ–Ω –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π —Å LLM-—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º

## –û–±–∑–æ—Ä

–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–º–µ–Ω–∞—Ö –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å –ø–æ–º–æ—â—å—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üéØ –£–ª—É—á—à–µ–Ω–Ω—ã–π workflow

1. **–û–±—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç** - —É–±—Ä–∞–Ω –≤—ã–±–æ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π
2. **–í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞**:
   - –ó–∞ 1 –º–µ—Å—è—Ü
   - –ó–∞ 3 –º–µ—Å—è—Ü–∞
   - –í—Å–µ –¥–∞–Ω–Ω—ã–µ

### ü§ñ AI-—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ LLM (Claude 3.5 Sonnet) –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:

- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º**
- **–ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π –ø–æ —Ü–≤–µ—Ç–∞–º**
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –º–æ–¥–µ–ª—è–º –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤**
- **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –ª–æ–∫–∞—Ü–∏—è–º**

### üìä –ú–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π Excel –æ—Ç—á–µ—Ç

–°–æ–∑–¥–∞–≤–∞–µ–º—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:

1. **–°–≤–æ–¥–∫–∞** - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
2. **–°—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º** - –∫–∞–∂–¥—ã–π —Ñ–∏–ª–∏–∞–ª –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
3. **–¢–æ–ø –ø—Ä–∏–Ω—Ç–µ—Ä—ã** - —Ä–µ–π—Ç–∏–Ω–≥ —Å–∞–º—ã—Ö –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ Telegram Bot

1. –í—ã–±—Ä–∞—Ç—å "–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö" ‚Üí "–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–º–µ–Ω –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π"
2. –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥ (1 –º–µ—Å—è—Ü, 3 –º–µ—Å—è—Ü–∞, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
3. –í—ã–±—Ä–∞—Ç—å —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ (Telegram / Email)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞

```
cartridge_analysis_YYYYMMDD_HHMMSS.xlsx
‚îú‚îÄ‚îÄ –°–≤–æ–¥–∫–∞                 # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îú‚îÄ‚îÄ [–§–∏–ª–∏–∞–ª 1]            # –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ñ–∏–ª–∏–∞–ª—É 1
‚îú‚îÄ‚îÄ [–§–∏–ª–∏–∞–ª 2]            # –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ñ–∏–ª–∏–∞–ª—É 2
‚îú‚îÄ‚îÄ ...                   # –î—Ä—É–≥–∏–µ —Ñ–∏–ª–∏–∞–ª—ã
‚îî‚îÄ‚îÄ –¢–æ–ø –ø—Ä–∏–Ω—Ç–µ—Ä—ã          # –†–µ–π—Ç–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π
```

## –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON –æ—Ç LLM

```json
{
  "summary": {
    "total_cartridges": 150,
    "period": "3months",
    "branches_count": 5,
    "colors": {
      "–ß–µ—Ä–Ω—ã–π": 80,
      "–°–∏–Ω–∏–π": 25,
      "–ñ–µ–ª—Ç—ã–π": 25,
      "–ü—É—Ä–ø—É—Ä–Ω—ã–π": 20
    }
  },
  "branches": [
    {
      "name": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ—Ñ–∏—Å",
      "cartridges_count": 45,
      "locations": [...]
    }
  ],
  "top_printers": [
    {
      "model": "HP LaserJet Pro M404n",
      "total_cartridges": 25
    }
  ]
}
```

## –†–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º

–ï—Å–ª–∏ LLM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –æ—Ç—á–µ—Ç —Å –ø—Ä–æ—Å—Ç–æ–π —Ç–∞–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- openai>=1.99.0
- openpyxl>=3.1.0
- pandas>=2.0.0
- OPENROUTER_API_KEY –≤ .env —Ñ–∞–π–ª–µ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞
python test_cartridge_export.py

# –ò–ª–∏ —á–µ—Ä–µ–∑ –±–∞—Ç–Ω–∏–∫
test_cartridge_export.bat
```

## –§–∞–π–ª—ã

- `bot/handlers/export.py` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
- `data/cartridge_replacements.json` - –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–º–µ–Ω–∞—Ö
- `exports/` - –ø–∞–ø–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —É—Ä–æ–≤–Ω–µ–º INFO, –æ—à–∏–±–∫–∏ - ERROR. –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ `bot.log`.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–µ—Ä–∏–æ–¥–∞–º
- Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ LLM
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤
- –¶–≤–µ—Ç–æ–≤–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ Excel
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫