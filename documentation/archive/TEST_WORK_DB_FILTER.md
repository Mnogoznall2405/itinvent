# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –ë–î –¥–ª—è —Ä–∞–±–æ—Ç

## –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ë–î (ITINVENT, MSK-ITINVENT –∏ —Ç.–¥.)

### –¢–µ—Å—Ç 1: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º–∏ –ë–î

**–®–∞–≥–∏:**
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –ë–î "ITINVENT"
   - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üóÑ –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚Üí ITINVENT
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –∑–∞–º–µ–Ω—É –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞
   - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üîß –†–∞–±–æ—Ç—ã ‚Üí üñ®Ô∏è –ó–∞–º–µ–Ω–∞ –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è
3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –ë–î "MSK-ITINVENT"
4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –µ—â–µ –æ–¥–Ω—É –∑–∞–º–µ–Ω—É –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `cartridge_replacements.json`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
[
  {
    "branch": "...",
    "location": "...",
    "printer_model": "...",
    "cartridge_color": "...",
    "db_name": "ITINVENT",
    "timestamp": "..."
  },
  {
    "branch": "...",
    "location": "...",
    "printer_model": "...",
    "cartridge_color": "...",
    "db_name": "MSK-ITINVENT",
    "timestamp": "..."
  }
]
```

### –¢–µ—Å—Ç 2: –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –ë–î

**–®–∞–≥–∏:**
1. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üìä –≠–∫—Å–ø–æ—Ä—Ç
2. –í—ã–±–µ—Ä–∏—Ç–µ "üñ®Ô∏è –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–º–µ–Ω –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π"
3. –í—ã–±–µ—Ä–∏—Ç–µ "üìÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ"
4. –í—ã–±–µ—Ä–∏—Ç–µ "üì¶ –í—Å–µ –±–∞–∑—ã"
5. –í—ã–±–µ—Ä–∏—Ç–µ "üí¨ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç"
6. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π Excel —Ñ–∞–π–ª

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –æ–±–µ–∏—Ö –ë–î
- –ö–æ–ª–æ–Ω–∫–∞ "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ITINVENT –∏ MSK-ITINVENT
- –ü–æ—Ä—è–¥–æ–∫ –∫–æ–ª–æ–Ω–æ–∫: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è, –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –§–∏–ª–∏–∞–ª, –õ–æ–∫–∞—Ü–∏—è, –ú–æ–¥–µ–ª—å –ø—Ä–∏–Ω—Ç–µ—Ä–∞, –¶–≤–µ—Ç –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞

### –¢–µ—Å—Ç 3: –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ë–î

**–®–∞–≥–∏:**
1. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üìä –≠–∫—Å–ø–æ—Ä—Ç
2. –í—ã–±–µ—Ä–∏—Ç–µ "üñ®Ô∏è –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–º–µ–Ω –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π"
3. –í—ã–±–µ—Ä–∏—Ç–µ "üìÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ"
4. –í—ã–±–µ—Ä–∏—Ç–µ "üèõ MSK-ITINVENT"
5. –í—ã–±–µ—Ä–∏—Ç–µ "üí¨ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç"
6. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π Excel —Ñ–∞–π–ª

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ –∏–∑ MSK-ITINVENT
- –í—Å–µ –∑–∞–ø–∏—Å–∏ –∏–º–µ—é—Ç "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö" = "MSK-ITINVENT"

### –¢–µ—Å—Ç 4: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

**–®–∞–≥–∏:**
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –ë–î "OBJ-ITINVENT"
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
   - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üîß –†–∞–±–æ—Ç—ã ‚Üí üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `equipment_installations.json`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
[
  {
    "branch": "...",
    "location": "...",
    "equipment_type": "...",
    "equipment_model": "...",
    "db_name": "OBJ-ITINVENT",
    "timestamp": "..."
  }
]
```

### –¢–µ—Å—Ç 5: –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `cartridge_replacements.json`
2. –£–¥–∞–ª–∏—Ç–µ –ø–æ–ª–µ `db_name` –∏–∑ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏ –≤—Ä—É—á–Ω—É—é:
```json
[
  {
    "branch": "–¢–µ—Å—Ç",
    "location": "–¢–µ—Å—Ç",
    "printer_model": "HP LaserJet",
    "cartridge_color": "–ß–µ—Ä–Ω—ã–π",
    "timestamp": "2025-10-21T10:00:00"
  }
]
```
3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∑–∞–º–µ–Ω—ã –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π (–≤—Å–µ –±–∞–∑—ã)
4. –û—Ç–∫—Ä–æ–π—Ç–µ Excel —Ñ–∞–π–ª

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ó–∞–ø–∏—Å—å –±–µ–∑ `db_name` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö" = "ITINVENT"
- –≠–∫—Å–ø–æ—Ä—Ç –Ω–µ –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
# Windows
type bot.log | findstr "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∑–∞–º–µ–Ω–∞ –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞"
type bot.log | findstr "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è"
type bot.log | findstr "–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–º–µ–Ω –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π"
type bot.log | findstr "–≠–∫—Å–ø–æ—Ä—Ç —É—Å—Ç–∞–Ω–æ–≤–æ–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è"
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –∑–∞–ø–∏—Å–∏:**
```
INFO - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∑–∞–º–µ–Ω–∞ –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞: {'branch': '...', 'db_name': 'ITINVENT', ...}
INFO - –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–º–µ–Ω –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π –∑–∞–≤–µ—Ä—à–µ–Ω: exports/cartridge_replacements_20251021_120000.xlsx
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: db_name –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `database_manager` –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ `bot/handlers/work.py`

### –ü—Ä–æ–±–ª–µ–º–∞: –§–∏–ª—å—Ç—Ä –ø–æ –ë–î –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `db_filter` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞:
```python
if 'db_name' not in df.columns:
    df['db_name'] = 'ITINVENT'
```

## –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

‚úÖ –í—Å–µ –∑–∞–ø–∏—Å–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –ø–æ–ª–µ–º `db_name`  
‚úÖ –≠–∫—Å–ø–æ—Ä—Ç "–í—Å–µ –±–∞–∑—ã" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏  
‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ë–î –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—ë –∑–∞–ø–∏—Å–∏  
‚úÖ –ö–æ–ª–æ–Ω–∫–∞ "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö" –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ Excel  
‚úÖ –°—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –Ω–∞ production –æ–∫—Ä—É–∂–µ–Ω–∏–∏
2. –û–±—É—á–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
